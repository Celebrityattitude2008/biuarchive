<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course Notes | BIUArchive</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-900 font-sans">

    <nav class="bg-blue-900 text-white p-4 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold tracking-tight">BIU<span class="text-blue-400">Archive</span></h1>
            <a href="/" class="text-sm hover:underline">Back to Home</a>
        </div>
    </nav>

    <main class="container mx-auto px-4 py-8">
        <div id="payment-box" class="bg-blue-50 border-l-4 border-blue-500 p-6 mb-8 rounded-r-lg shadow-md">
            <div class="flex flex-col md:flex-row justify-between gap-6">
                <div>
                    <h3 class="text-lg font-bold text-blue-900 mb-2">Unlock Premium Access</h3>
                    <p class="text-blue-800 mb-4">Transfer <b>â‚¦5,000</b> to the account below:</p>
                    <div class="bg-white p-4 rounded-lg border border-blue-200 inline-block">
                        <p class="text-xs text-gray-500 font-bold">Bank: <span class="text-gray-800">OPay</span></p>
                        <p class="text-xs text-gray-500 font-bold mt-1">Acc No: <span class="text-blue-700 text-lg">7041795388</span></p>
                        <p class="text-xs text-gray-500 font-bold mt-1">Name: <span class="text-gray-800">Paul Adamu</span></p>
                    </div>
                </div>
                <div class="flex flex-col justify-center">
                    <button onclick="startVerification()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-10 rounded-xl transition-all shadow-lg">
                        I Have Made the Transfer
                    </button>
                </div>
            </div>
        </div>

        <div id="status-overlay" class="hidden fixed inset-0 bg-blue-900/80 backdrop-blur-sm flex items-center justify-center z-50 p-4">
            <div class="bg-white p-8 rounded-2xl max-w-sm w-full text-center shadow-2xl">
                <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-blue-600 mx-auto mb-6"></div>
                <h3 class="text-2xl font-bold text-gray-800">Verifying Payment...</h3>
                <p class="text-gray-600 mt-4 text-sm">Please do not close this page. Paul is verifying your receipt on WhatsApp.</p>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-white p-6 rounded-xl shadow-md border border-gray-100">
                <h3 class="text-xl font-bold border-b pb-2 mb-4 text-blue-900">CSC 111 Notes</h3>
                <ul class="space-y-3" id="csc-list">
                    <li class="flex justify-between items-center"><span>Week 1 Note</span><a href="#" class="note-link text-gray-400 cursor-not-allowed" data-url="https://docs.google.com/document/d/1h4bQbzrBq0Wy-Einz69xmdYMWz55ydY3/edit">Locked ðŸ”’</a></li>
                    <li class="flex justify-between items-center"><span>Week 2 Note</span><a href="#" class="note-link text-gray-400 cursor-not-allowed" data-url="https://docs.google.com/document/d/1jh4GRfoYRw6MTaDj_I2XkUeDhwWPSSES/edit">Locked ðŸ”’</a></li>
                </ul>
            </div>
        </div>
    </main>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, onValue, set, push } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBmZDLDyQ2YhMxsYal1q4d0hyr03VXEqak",
            authDomain: "biu-archive.firebaseapp.com",
            databaseURL: "https://biu-archive-default-rtdb.firebaseio.com",
            projectId: "biu-archive",
            storageBucket: "biu-archive.firebasestorage.app",
            messagingSenderId: "245967347998",
            appId: "1:245967347998:web:a8feb5ad0ef9650946a90f"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        let userId = localStorage.getItem('biu_user_id') || ('user_' + Math.random().toString(36).substr(2, 9));
        localStorage.setItem('biu_user_id', userId);

        onValue(ref(db, "paid_users/" + userId), (snapshot) => {
            if (snapshot.val() === true) { unlockNotes(); }
        });

        window.startVerification = function() {
            const studentName = prompt("Enter your Full Name for verification:");
            if (!studentName) return;

            document.getElementById('status-overlay').classList.remove('hidden');
            push(ref(db, "payment_requests"), { userId, name: studentName, time: new Date().toLocaleString() });

            const whatsappUrl = `https://wa.me/2347041795388?text=${encodeURIComponent("Payment for notes. Name: " + studentName + ". ID: " + userId)}`;
            setTimeout(() => { window.open(whatsappUrl, '_blank'); }, 2000);
        }

        function unlockNotes() {
            document.getElementById('status-overlay').classList.add('hidden');
            document.getElementById('payment-box').style.display = 'none';
            document.querySelectorAll('.note-link').forEach(link => {
                link.setAttribute('href', link.getAttribute('data-url'));
                link.classList.replace('text-gray-400', 'text-green-600');
                link.classList.remove('cursor-not-allowed');
                link.innerHTML = 'Download ðŸ”“';
            });
        }
    </script>
</body>
</html>